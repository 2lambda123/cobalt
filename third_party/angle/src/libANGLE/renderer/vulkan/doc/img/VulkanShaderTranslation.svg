<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="1185" height="1229"><source><![CDATA[participant App
participant "ANGLE Front-end"
participant "Vulkan Back-end"
participant "ANGLE Translator"
participant "GlslangWrapperVk"
participant "Glslang"

App->"ANGLE Front-end": glCompileShader (VS)
"ANGLE Front-end"->"Vulkan Back-end": ShaderVk::compile
"Vulkan Back-end"->"ANGLE Translator": sh::Compile
"ANGLE Translator"-->"ANGLE Front-end": return Vulkan-compatible GLSL

Note right of "ANGLE Front-end": Source is templated\nwith markers to be\nfilled at link time.

Note right of App: Same for FS, GS, etc...

App->"ANGLE Front-end": glCreateProgram (...)
App->"ANGLE Front-end": glAttachShader (...)
App->"ANGLE Front-end": glLinkProgram
"ANGLE Front-end"->"Vulkan Back-end": ProgramVk::link

Note right of "Vulkan Back-end": ProgramVk inits uniforms,\nlayouts, and descriptors.

"Vulkan Back-end"->GlslangWrapperVk: GlslangWrapperVk::GetShaderSource
GlslangWrapperVk-->"Vulkan Back-end": return filled-in sources

Note right of "Vulkan Back-end": Source is templated with\ndefines to be resolved at\ndraw time.

"Vulkan Back-end"-->"ANGLE Front-end": return success

Note right of App: App execution continues...

App->"ANGLE Front-end": glDrawArrays (any draw)
"ANGLE Front-end"->"Vulkan Back-end": ContextVk::drawArrays

"Vulkan Back-end"->GlslangWrapperVk: GlslangWrapperVk::GetShaderCode (with defines)
GlslangWrapperVk->Glslang: GlslangToSpv
Glslang-->"Vulkan Back-end": Return SPIR-V 

Note right of "Vulkan Back-end": We init VkShaderModules\nand VkPipeline then\nrecord the draw.

"Vulkan Back-end"-->"ANGLE Front-end": return success
]]></source><desc/><defs><marker id="markerArrowBlock" markerHeight="5" markerWidth="5" orient="auto" refX="5" refY="2.5" viewBox="0 0 5 5"><path d="M 0 0 L 5 2.5 L 0 5 z"/></marker><marker id="markerArrowOpen" markerHeight="16" markerWidth="4" orient="auto" refX="9.6" refY="8" viewBox="0 0 9.6 16"><path d="M 9.6,8 1.92,16 0,13.7 5.76,8 0,2.286 1.92,0 9.6,8 z"/></marker></defs><g class="actor"><rect width="47.594" height="39" x="10" y="20" fill="#fff" stroke="#000" style="stroke-width:2"/><text x="21" y="45" style="font-size:16px;font-family:&quot;Andale Mono&quot;,monospace"><tspan x="20">App</tspan></text></g><g class="actor"><rect width="47.594" height="39" x="10" y="1170.359" fill="#fff" stroke="#000" style="stroke-width:2"/><text x="21" y="1195.359" style="font-size:16px;font-family:&quot;Andale Mono&quot;,monospace"><tspan x="20">App</tspan></text></g><line x1="33.797" x2="33.797" y1="59" y2="1170.359" fill="none" stroke="#000" style="stroke-width:2"/><g class="actor"><rect width="152.953" height="39" x="237.039" y="20" fill="#fff" stroke="#000" style="stroke-width:2"/><text x="248.039" y="45" style="font-size:16px;font-family:&quot;Andale Mono&quot;,monospace"><tspan x="247.039">ANGLE Front-end</tspan></text></g><g class="actor"><rect width="152.953" height="39" x="237.039" y="1170.359" fill="#fff" stroke="#000" style="stroke-width:2"/><text x="248.039" y="1195.359" style="font-size:16px;font-family:&quot;Andale Mono&quot;,monospace"><tspan x="247.039">ANGLE Front-end</tspan></text></g><line x1="313.516" x2="313.516" y1="59" y2="1170.359" fill="none" stroke="#000" style="stroke-width:2"/><g class="actor"><rect width="152.953" height="39" x="462.977" y="20" fill="#fff" stroke="#000" style="stroke-width:2"/><text x="473.977" y="45" style="font-size:16px;font-family:&quot;Andale Mono&quot;,monospace"><tspan x="472.977">Vulkan Back-end</tspan></text></g><g class="actor"><rect width="152.953" height="39" x="462.977" y="1170.359" fill="#fff" stroke="#000" style="stroke-width:2"/><text x="473.977" y="1195.359" style="font-size:16px;font-family:&quot;Andale Mono&quot;,monospace"><tspan x="472.977">Vulkan Back-end</tspan></text></g><line x1="539.453" x2="539.453" y1="59" y2="1170.359" fill="none" stroke="#000" style="stroke-width:2"/><g class="actor"><rect width="161.953" height="39" x="728.398" y="20" fill="#fff" stroke="#000" style="stroke-width:2"/><text x="739.398" y="45" style="font-size:16px;font-family:&quot;Andale Mono&quot;,monospace"><tspan x="738.398">ANGLE Translator</tspan></text></g><g class="actor"><rect width="161.953" height="39" x="728.398" y="1170.359" fill="#fff" stroke="#000" style="stroke-width:2"/><text x="739.398" y="1195.359" style="font-size:16px;font-family:&quot;Andale Mono&quot;,monospace"><tspan x="738.398">ANGLE Translator</tspan></text></g><line x1="809.375" x2="809.375" y1="59" y2="1170.359" fill="none" stroke="#000" style="stroke-width:2"/><g class="actor"><rect width="143.359" height="39" x="910.352" y="20" fill="#fff" stroke="#000" style="stroke-width:2"/><text x="920.352" y="45" style="font-size:16px;font-family:&quot;Andale Mono&quot;,monospace"><tspan x="920.352">GlslangWrapperVk</tspan></text></g><g class="actor"><rect width="143.359" height="39" x="910.352" y="1170.359" fill="#fff" stroke="#000" style="stroke-width:2"/><text x="920.352" y="1195.359" style="font-size:16px;font-family:&quot;Andale Mono&quot;,monospace"><tspan x="920.352">GlslangWrapperVk</tspan></text></g><line x1="982.031" x2="982.031" y1="59" y2="1170.359" fill="none" stroke="#000" style="stroke-width:2"/><g class="actor"><rect width="81.781" height="39" x="1073.711" y="20" fill="#fff" stroke="#000" style="stroke-width:2"/><text x="1083.711" y="45" style="font-size:16px;font-family:&quot;Andale Mono&quot;,monospace"><tspan x="1083.711">Glslang</tspan></text></g><g class="actor"><rect width="81.781" height="39" x="1073.711" y="1170.359" fill="#fff" stroke="#000" style="stroke-width:2"/><text x="1083.711" y="1195.359" style="font-size:16px;font-family:&quot;Andale Mono&quot;,monospace"><tspan x="1083.711">Glslang</tspan></text></g><line x1="1114.602" x2="1114.602" y1="59" y2="1170.359" fill="none" stroke="#000" style="stroke-width:2"/><g class="signal"><text x="85.688" y="89.5" style="font-size:16px;font-family:&quot;Andale Mono&quot;,monospace"><tspan x="85.688">glCompileShader (VS)</tspan></text><line x1="33.797" x2="313.516" y1="98" y2="98" fill="none" stroke="#000" style="stroke-width:2;marker-end:url(#markerArrowBlock)"/></g><g class="signal"><text x="351.609" y="128.5" style="font-size:16px;font-family:&quot;Andale Mono&quot;,monospace"><tspan x="351.609">ShaderVk::compile</tspan></text><line x1="313.516" x2="539.453" y1="137" y2="137" fill="none" stroke="#000" style="stroke-width:2;marker-end:url(#markerArrowBlock)"/></g><g class="signal"><text x="625.93" y="167.5" style="font-size:16px;font-family:&quot;Andale Mono&quot;,monospace"><tspan x="625.93">sh::Compile</tspan></text><line x1="539.453" x2="809.375" y1="176" y2="176" fill="none" stroke="#000" style="stroke-width:2;marker-end:url(#markerArrowBlock)"/></g><g class="signal"><text x="433.891" y="206.5" style="font-size:16px;font-family:&quot;Andale Mono&quot;,monospace"><tspan x="433.891">return Vulkan-compatible GLSL</tspan></text><line x1="809.375" x2="313.516" y1="215" y2="215" fill="none" stroke="#000" style="stroke-width:2;stroke-dasharray:6,2;marker-end:url(#markerArrowBlock)"/></g><g class="note"><rect width="185.938" height="67.391" x="333.516" y="235" fill="#fff" stroke="#000" style="stroke-width:2"/><text x="338.516" y="255" style="font-size:16px;font-family:&quot;Andale Mono&quot;,monospace"><tspan x="338.516">Source is templated</tspan><tspan x="338.516" dy="1.2em">with markers to be</tspan><tspan x="338.516" dy="1.2em">filled at link time.</tspan></text></g><g class="note"><rect width="212.328" height="29" x="53.797" y="322.391" fill="#fff" stroke="#000" style="stroke-width:2"/><text x="58.797" y="342.391" style="font-size:16px;font-family:&quot;Andale Mono&quot;,monospace"><tspan x="58.797">Same for FS, GS, etc...</tspan></text></g><g class="signal"><text x="81.289" y="381.891" style="font-size:16px;font-family:&quot;Andale Mono&quot;,monospace"><tspan x="81.289">glCreateProgram (...)</tspan></text><line x1="33.797" x2="313.516" y1="390.391" y2="390.391" fill="none" stroke="#000" style="stroke-width:2;marker-end:url(#markerArrowBlock)"/></g><g class="signal"><text x="85.688" y="420.891" style="font-size:16px;font-family:&quot;Andale Mono&quot;,monospace"><tspan x="85.688">glAttachShader (...)</tspan></text><line x1="33.797" x2="313.516" y1="429.391" y2="429.391" fill="none" stroke="#000" style="stroke-width:2;marker-end:url(#markerArrowBlock)"/></g><g class="signal"><text x="116.375" y="459.891" style="font-size:16px;font-family:&quot;Andale Mono&quot;,monospace"><tspan x="116.375">glLinkProgram</tspan></text><line x1="33.797" x2="313.516" y1="468.391" y2="468.391" fill="none" stroke="#000" style="stroke-width:2;marker-end:url(#markerArrowBlock)"/></g><g class="signal"><text x="360.406" y="498.891" style="font-size:16px;font-family:&quot;Andale Mono&quot;,monospace"><tspan x="360.406">ProgramVk::link</tspan></text><line x1="313.516" x2="539.453" y1="507.391" y2="507.391" fill="none" stroke="#000" style="stroke-width:2;marker-end:url(#markerArrowBlock)"/></g><g class="note"><rect width="229.922" height="48.188" x="559.453" y="527.391" fill="#fff" stroke="#000" style="stroke-width:2"/><text x="564.453" y="547.391" style="font-size:16px;font-family:&quot;Andale Mono&quot;,monospace"><tspan x="564.453">ProgramVk inits uniforms,</tspan><tspan x="564.453" dy="1.2em">layouts, and descriptors.</tspan></text></g><g class="signal"><text x="624.289" y="606.078" style="font-size:16px;font-family:&quot;Andale Mono&quot;,monospace"><tspan x="624.289">GlslangWrapperVk::GetShaderSource</tspan></text><line x1="539.453" x2="982.031" y1="614.578" y2="614.578" fill="none" stroke="#000" style="stroke-width:2;marker-end:url(#markerArrowBlock)"/></g><g class="signal"><text x="655.18" y="645.078" style="font-size:16px;font-family:&quot;Andale Mono&quot;,monospace"><tspan x="655.18">return filled-in sources</tspan></text><line x1="982.031" x2="539.453" y1="653.578" y2="653.578" fill="none" stroke="#000" style="stroke-width:2;stroke-dasharray:6,2;marker-end:url(#markerArrowBlock)"/></g><g class="note"><rect width="229.922" height="67.391" x="559.453" y="673.578" fill="#fff" stroke="#000" style="stroke-width:2"/><text x="564.453" y="693.578" style="font-size:16px;font-family:&quot;Andale Mono&quot;,monospace"><tspan x="564.453">Source is templated with</tspan><tspan x="564.453" dy="1.2em">defines to be resolved at</tspan><tspan x="564.453" dy="1.2em">draw time.</tspan></text></g><g class="signal"><text x="364.906" y="771.469" style="font-size:16px;font-family:&quot;Andale Mono&quot;,monospace"><tspan x="364.906">return success</tspan></text><line x1="539.453" x2="313.516" y1="779.969" y2="779.969" fill="none" stroke="#000" style="stroke-width:2;stroke-dasharray:6,2;marker-end:url(#markerArrowBlock)"/></g><g class="note"><rect width="239.719" height="29" x="53.797" y="799.969" fill="#fff" stroke="#000" style="stroke-width:2"/><text x="59.797" y="819.969" style="font-size:16px;font-family:&quot;Andale Mono&quot;,monospace"><tspan x="58.797">App execution continues...</tspan></text></g><g class="signal"><text x="72.492" y="859.469" style="font-size:16px;font-family:&quot;Andale Mono&quot;,monospace"><tspan x="72.492">glDrawArrays (any draw)</tspan></text><line x1="33.797" x2="313.516" y1="867.969" y2="867.969" fill="none" stroke="#000" style="stroke-width:2;marker-end:url(#markerArrowBlock)"/></g><g class="signal"><text x="334.117" y="898.469" style="font-size:16px;font-family:&quot;Andale Mono&quot;,monospace"><tspan x="334.117">ContextVk::drawArrays</tspan></text><line x1="313.516" x2="539.453" y1="906.969" y2="906.969" fill="none" stroke="#000" style="stroke-width:2;marker-end:url(#markerArrowBlock)"/></g><g class="signal"><text x="567.211" y="937.469" style="font-size:16px;font-family:&quot;Andale Mono&quot;,monospace"><tspan x="567.211">GlslangWrapperVk::GetShaderCode (with defines)</tspan></text><line x1="539.453" x2="982.031" y1="945.969" y2="945.969" fill="none" stroke="#000" style="stroke-width:2;marker-end:url(#markerArrowBlock)"/></g><g class="signal"><text x="995.434" y="976.469" style="font-size:16px;font-family:&quot;Andale Mono&quot;,monospace"><tspan x="995.434">GlslangToSpv</tspan></text><line x1="982.031" x2="1114.602" y1="984.969" y2="984.969" fill="none" stroke="#000" style="stroke-width:2;marker-end:url(#markerArrowBlock)"/></g><g class="signal"><text x="769.246" y="1015.469" style="font-size:16px;font-family:&quot;Andale Mono&quot;,monospace"><tspan x="769.246">Return SPIR-V</tspan></text><line x1="1114.602" x2="539.453" y1="1023.969" y2="1023.969" fill="none" stroke="#000" style="stroke-width:2;stroke-dasharray:6,2;marker-end:url(#markerArrowBlock)"/></g><g class="note"><rect width="212.328" height="67.391" x="559.453" y="1043.969" fill="#fff" stroke="#000" style="stroke-width:2"/><text x="564.453" y="1063.969" style="font-size:16px;font-family:&quot;Andale Mono&quot;,monospace"><tspan x="564.453">We init VkShaderModules</tspan><tspan x="564.453" dy="1.2em">and VkPipeline then</tspan><tspan x="564.453" dy="1.2em">record the draw.</tspan></text></g><g class="signal"><text x="364.906" y="1141.859" style="font-size:16px;font-family:&quot;Andale Mono&quot;,monospace"><tspan x="364.906">return success</tspan></text><line x1="539.453" x2="313.516" y1="1150.359" y2="1150.359" fill="none" stroke="#000" style="stroke-width:2;stroke-dasharray:6,2;marker-end:url(#markerArrowBlock)"/></g></svg>